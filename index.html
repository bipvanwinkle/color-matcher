<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body id="background" style="background-color: blue">
        <div
            id="target"
            style="
                height: 300px;
                width: 300px;
                background-color: rgb(0, 0, 0);
                border-radius: 150px;
            "
        ></div>
        <div style="display: flex; flex-direction: row">
            <div style="display: flex; flex-direction: column">
                <h2 id="red-label">Redness</h2>
                <button id="more-red">More Red (q)</button>
                <button id="less-red">Less Red (a)</button>
            </div>
            <div style="display: flex; flex-direction: column">
                <h2 id="green-label">Greenness</h2>
                <button id="more-green">More Green (w)</button>
                <button id="less-green">Less Green (s)</button>
            </div>
            <div style="display: flex; flex-direction: column">
                <h2 id="blue-label">Blueness</h2>
                <button id="more-blue">More Blue (e)</button>
                <button id="less-blue">Less Blue (d)</button>
            </div>
        </div>
        <button id="check">Check My Answer</button>
    </body>
    <script
        src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
        crossorigin="anonymous"
    ></script>
    <script
        src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
        integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
        crossorigin="anonymous"
    ></script>
    <script>
        $("#target").draggable({ revert: true });
        function getRandomInt(high = 255) {
            return Math.ceil(Math.random() * high);
        }
        let targetColor = {
            red: getRandomInt(),
            green: getRandomInt(),
            blue: getRandomInt()
        };
        let backgroundColor = {
            red: getRandomInt(),
            green: getRandomInt(),
            blue: getRandomInt()
        };
        function updateBackground({ red, green, blue } = {}) {
            const background = document.getElementById("background");
            const newRgb = {
                ...backgroundColor,
                ...(red && red > 0 && red < 256 && { red }),
                ...(green && green > 0 && green < 255 && { green }),
                ...(blue && blue > 0 && blue < 255 && { blue })
            };

            background.style[
                "background-color"
            ] = `rgb(${newRgb.red}, ${newRgb.green}, ${newRgb.blue})`;
            backgroundColor = newRgb;
        }
        function updateTarget({ red, green, blue } = {}) {
            const target = document.getElementById("target");
            const newRgb = {
                ...targetColor,
                ...(red && red > 0 && red < 255 && { red }),
                ...(green && green > 0 && green < 255 && { green }),
                ...(blue && blue > 0 && blue < 255 && { blue })
            };
            target.style[
                "background-color"
            ] = `rgb(${newRgb.red}, ${newRgb.green}, ${newRgb.blue})`;
            const redLabel = document.getElementById("red-label");
            redLabel.innerText = `Redness: ${newRgb.red}`;
            const greenLabel = document.getElementById("green-label");
            greenLabel.innerText = `Greenness: ${newRgb.green}`;
            const blueLabel = document.getElementById("blue-label");
            blueLabel.innerText = `Blueness: ${newRgb.blue}`;
            targetColor = newRgb;
        }
        function check() {
            if (
                targetColor.red === backgroundColor.red &&
                targetColor.green === backgroundColor.green &&
                targetColor.blue === backgroundColor.blue
            ) {
                alert("You got it right!");
            } else {
                alert("You got it wrong");
            }
        }
        document.getElementById("less-red").addEventListener("click", (event) => {
            updateTarget({ red: targetColor.red - 1 });
        });
        document.getElementById("more-red").addEventListener("click", (event) => {
            updateTarget({ red: targetColor.red + 1 });
        });
        document.getElementById("less-green").addEventListener("click", (event) => {
            updateTarget({ green: targetColor.green - 1 });
        });
        document.getElementById("more-green").addEventListener("click", (event) => {
            updateTarget({ green: targetColor.green + 1 });
        });
        document.getElementById("less-blue").addEventListener("click", (event) => {
            updateTarget({ blue: targetColor.blue - 1 });
        });
        document.getElementById("more-blue").addEventListener("click", (event) => {
            updateTarget({ blue: targetColor.blue + 1 });
        });

        document.getElementById("check").addEventListener("click", (event) => {
            check();
        });

        window.addEventListener("keydown", (event) => {
            const target = document.getElementById("target");
            if (event.code === "KeyQ") {
                updateTarget({ red: targetColor.red + 1 });
            } else if (event.code === "KeyA") {
                updateTarget({ red: targetColor.red - 1 });
            } else if (event.code === "KeyW") {
                updateTarget({ green: targetColor.green + 1 });
            } else if (event.code === "KeyS") {
                updateTarget({ green: targetColor.green - 1 });
            } else if (event.code === "KeyE") {
                updateTarget({ blue: targetColor.blue + 1 });
            } else if (event.code === "KeyD") {
                updateTarget({ blue: targetColor.blue - 1 });
            } else if (event.code === "Enter") {
                check();
            }
        });
        updateTarget(targetColor);
        updateBackground(backgroundColor);
    </script>
</html>
