<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body id="background" style="background-color: blue">
        <div
            id="target"
            style="
                height: 300px;
                width: 300px;
                background-color: rgb(0, 0, 0);
                border-radius: 150px;
            "
        ></div>
        <div style="display: flex; flex-direction: row">
            <div style="display: flex; flex-direction: column">
                <h2 id="red-label">Redness</h2>
                <button id="less-red">Less Red (a)</button>
                <button id="more-red">More Red (q)</button>
            </div>
            <div style="display: flex; flex-direction: column">
                <h2 id="green-label">Greenness</h2>
                <button id="less-green">Less Green (s)</button>
                <button id="more-green">More Green (w)</button>
            </div>
            <div style="display: flex; flex-direction: column">
                <h2 id="blue-label">Blueness</h2>
                <button id="less-blue">Less Blue (e)</button>
                <button id="more-blue">More Blue (d)</button>
            </div>
        </div>
        <button id="check">Check My Answer</button>
    </body>
    <script>
        function colorValues(color) {
            if (color === "") return;
            if (color.toLowerCase() === "transparent") return [0, 0, 0, 0];
            if (color[0] === "#") {
                if (color.length < 7) {
                    // convert #RGB and #RGBA to #RRGGBB and #RRGGBBAA
                    color =
                        "#" +
                        color[1] +
                        color[1] +
                        color[2] +
                        color[2] +
                        color[3] +
                        color[3] +
                        (color.length > 4 ? color[4] + color[4] : "");
                }
                return [
                    parseInt(color.substr(1, 2), 16),
                    parseInt(color.substr(3, 2), 16),
                    parseInt(color.substr(5, 2), 16),
                    color.length > 7 ? parseInt(color.substr(7, 2), 16) / 255 : 1
                ];
            }
            if (color.indexOf("rgb") === -1) {
                // convert named colors
                var temp_elem = document.body.appendChild(document.createElement("fictum")); // intentionally use unknown tag to lower chances of css rule override with !important
                var flag = "rgb(1, 2, 3)"; // this flag tested on chrome 59, ff 53, ie9, ie10, ie11, edge 14
                temp_elem.style.color = flag;
                if (temp_elem.style.color !== flag) return; // color set failed - some monstrous css rule is probably taking over the color of our object
                temp_elem.style.color = color;
                if (temp_elem.style.color === flag || temp_elem.style.color === "") return; // color parse failed
                color = getComputedStyle(temp_elem).color;
                document.body.removeChild(temp_elem);
            }
            if (color.indexOf("rgb") === 0) {
                if (color.indexOf("rgba") === -1) color += ",1"; // convert 'rgb(R,G,B)' to 'rgb(R,G,B)A' which looks awful but will pass the regxep below
                return color.match(/[\.\d]+/g).map(function (a) {
                    return +a;
                });
            }
        }
        document.getElementById("less-red").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const [red, green, blue] = colorValues(target.style["background-color"]);
            if (red > 0) {
                target.style["background-color"] = `rgb(${red - 1}, ${green}, ${blue})`;
            }

            const redLabel = document.getElementById("red-label");
            redLabel.innerText = `Redness: ${red - 1}`;
        });
        document.getElementById("more-red").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const [red, green, blue] = colorValues(target.style["background-color"]);
            if (red < 256) {
                target.style["background-color"] = `rgb(${red + 1}, ${green}, ${blue})`;
            }
            const redLabel = document.getElementById("red-label");
            redLabel.innerText = `Redness: ${red + 1}`;
        });
        document.getElementById("less-green").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const [red, green, blue] = colorValues(target.style["background-color"]);
            if (green > 0) {
                target.style["background-color"] = `rgb(${red}, ${green - 1}, ${blue})`;
            }
            const greenLabel = document.getElementById("green-label");
            greenLabel.innerText = `Greenness: ${green - 1}`;
        });
        document.getElementById("more-green").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const [red, green, blue] = colorValues(target.style["background-color"]);
            if (green < 256) {
                target.style["background-color"] = `rgb(${red}, ${green + 1}, ${blue})`;
            }
            const greenLabel = document.getElementById("green-label");
            greenLabel.innerText = `Greenness: ${green + 1}`;
        });
        document.getElementById("less-blue").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const [red, green, blue] = colorValues(target.style["background-color"]);
            if (blue > 0) {
                target.style["background-color"] = `rgb(${red}, ${green}, ${blue - 1})`;
            }
            const blueLabel = document.getElementById("blue-label");
            blueLabel.innerText = `Blueness: ${blue - 1}`;
        });
        document.getElementById("more-blue").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const [red, green, blue] = colorValues(target.style["background-color"]);
            if (blue < 256) {
                target.style["background-color"] = `rgb(${red}, ${green}, ${blue + 1})`;
            }
            const blueLabel = document.getElementById("blue-label");
            blueLabel.innerText = `Blueness: ${blue + 1}`;
        });

        document.getElementById("check").addEventListener("click", (event) => {
            const target = document.getElementById("target");
            const background = document.getElementById("background");

            const [targetRed, targetGreen, targetBlue] = colorValues(
                target.style["background-color"]
            );
            const [backgroundRed, backgroundGreen, backgroundBlue] = colorValues(
                background.style["background-color"]
            );

            if (
                targetRed === backgroundRed &&
                targetGreen === backgroundGreen &&
                targetBlue === backgroundBlue
            ) {
                alert("You got it right!");
            } else {
                alert("You got it wrong");
            }
        });

        window.addEventListener("keydown", (event) => {
            const target = document.getElementById("target");
            if (event.code === "KeyQ") {
                const [red, green, blue] = colorValues(target.style["background-color"]);
                const newRed = red < 256 ? red + 1 : red;
                target.style["background-color"] = `rgb(${newRed}, ${green}, ${blue})`;
                const redLabel = document.getElementById("red-label");
                redLabel.innerText = `Redness: ${newRed}`;
            } else if (event.code === "KeyA") {
                const [red, green, blue] = colorValues(target.style["background-color"]);
                const newRed = red > 0 ? red - 1 : red;
                target.style["background-color"] = `rgb(${newRed}, ${green}, ${blue})`;
                const redLabel = document.getElementById("red-label");
                redLabel.innerText = `Redness: ${newRed}`;
            } else if (event.code === "KeyW") {
                const [red, green, blue] = colorValues(target.style["background-color"]);
                const newGreen = green < 256 ? green + 1 : green;
                target.style["background-color"] = `rgb(${red}, ${newGreen}, ${blue})`;
                const greenLabel = document.getElementById("green-label");
                greenLabel.innerText = `Greenness: ${newGreen}`;
            } else if (event.code === "KeyS") {
                const [red, green, blue] = colorValues(target.style["background-color"]);
                const newGreen = green > 0 ? green - 1 : green;
                target.style["background-color"] = `rgb(${red}, ${newGreen}, ${blue})`;
                const greenLabel = document.getElementById("green-label");
                greenLabel.innerText = `Greenness: ${newGreen}`;
            } else if (event.code === "KeyE") {
                const [red, green, blue] = colorValues(target.style["background-color"]);
                const newBlue = blue < 256 ? blue + 1 : blue;
                target.style["background-color"] = `rgb(${red}, ${green}, ${newBlue})`;
                const blueLabel = document.getElementById("blue-label");
                blueLabel.innerText = `Blueness: ${newBlue}`;
            } else if (event.code === "KeyD") {
                const [red, green, blue] = colorValues(target.style["background-color"]);
                const newBlue = blue > 0 ? blue - 1 : blue;
                target.style["background-color"] = `rgb(${red}, ${green}, ${newBlue})`;
                const blueLabel = document.getElementById("blue-label");
                blueLabel.innerText = `Blueness: ${newBlue}`;
            }
        });

        window.addEventListener("load", (event) => {
            const target = document.getElementById("target");
            target.style["background-color"] = `rgb(${Math.ceil(Math.random() * 255)}, ${Math.ceil(
                Math.random() * 255
            )}, ${Math.ceil(Math.random() * 255)})`;
            const [red, green, blue] = colorValues(target.style["background-color"]);
            const background = document.getElementById("background");
            background.style["background-color"] = `rgb(${Math.ceil(
                Math.random() * 255
            )}, ${Math.ceil(Math.random() * 255)}, ${Math.ceil(Math.random() * 255)})`;

            const redLabel = document.getElementById("red-label");
            redLabel.innerText = `Redness: ${red}`;
            const greenLabel = document.getElementById("green-label");
            greenLabel.innerText = `Greenness: ${green}`;
            const blueLabel = document.getElementById("blue-label");
            blueLabel.innerText = `Blueness: ${blue}`;
        });
    </script>
</html>
